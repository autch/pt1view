<!DOCTYPE html> 
<html>
  <head>
    <meta charset="UTF-8"/>
    <title>pt1view</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.3.1.min.css" />
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/jquery.mobile-1.3.1.min.js"></script>
    <script src="js/handlebars.js"></script>
    <link rel="stylesheet" href="css/m.css" />
    <script src="js/m.js"></script>
    <style>
      .ui-li-aside { width: auto; }
    </style>
  </head>
  <body>
    <div data-role="page" id="main">
      <div data-role="header">
	<a href="#" id="reload-programs" data-icon="refresh">番組表更新</a>
	<h1>pt1view</h1>
	<a href="#processes" data-rel="popup" data-position-to="origin" data-icon="grid" class="ui-btn-right">プロセス</a>
      </div><!-- /header -->
      <div id="messages" class="ui-bar ui-bar-e" style="display: none;">
	<a href="#" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-left">閉じる</a>
	<h3></h3>
      </div>
      <div data-role="content">
	<ul data-role="listview" id="program" data-split-theme="d" data-split-icon="info">
	</ul>
      </div><!-- /content -->
      <div data-role="popup" id="program-detail" data-theme="d" data-overlay-theme="b" class="ui-content">
	<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-left">閉じる</a>
	<h3>番組詳細</h3>
	<div id="program-detail-content">
	</div>
      </div>
      <div data-role="popup" id="processes" data-theme="d" data-overlay-theme="b" class="ui-content">
	<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-left">閉じる</a>
	<h3>実行中のプロセス</h3>
	<div id="process-detail-content">
	  <table data-role="table" id="process-table" data-mode="reflow" class="ui-responsive table-stroke">
	    <thead>
	      <tr><th>PID</th><th>コマンド</th><th>操作</th><th>視聴</th></tr>
	    </thead>
	    <tbody>
	    </tbody>
	  </table>
	</div>
      </div>
      <div data-role="popup" id="new-stream" data-theme="d" data-overlay-theme="a" data-dismissible="false">
	<div data-role="header">
	<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-left">キャンセル</a>
	  <h1>ストリームを開始</h1>
	</div><!-- /header -->

	<div data-role="content">
	  <form method="POST">
	    <ul data-role="listview">
	      <li data-role="fieldcontain">
		<label for="device">PT1/2 デバイス</label>
		<input type="text" name="device" id="device" value="" placeholder="自動検出">
	      </li>
	      <li data-role="fieldcontain">
		<label for="ch">物理チャンネル</label>
		<select name="ch" id="ch"></select>
	      </li>
	      <li data-role="fieldcontain">
		<fieldset data-role="controlgroup" data-type="horizontal">
		  <legend>オプション</legend>
		  <label for="b25">B25 復号</label>
		  <input type="checkbox" name="b25" id="b25" checked>
		  <label for="strip">NULL 除去</label>
		  <input type="checkbox" name="strip" id="strip" checked>
		</fieldset>
	      </li>
	      <li data-role="fieldcontain">
		<label for="tcp_port">TCP ポート番号</label>
		<input type="number" name="tcp_port" id="tcp_port" value="11234" placeholder="TCP ポート番号">
	      </li>
	      <li data-role="fieldcontain" id="udp_peer">
		<label for="addr">UDP ホスト:ポート</label>
		<input type="text" name="addr" id="addr" value="" placeholder="UDP ホスト">
		<input type="number" name="port" id="port" value="1234" placeholder="UDP ポート番号">
	      </li>
	      <li data-role="fieldcontain">
		<fieldset class="ui-grid-a">
		  <div class="ui-block-a"><button data-action="start" data-method="tcp">TCP</button></div>
		  <div class="ui-block-b"><button data-action="start" data-method="udp">UDP</button></div>
		</fieldset>
	      </li>
	    </ul>
	  </form>
	</div>
      </div>
      <div data-role="footer" class="ui-bar">
	<a href="index.html" target="_self">フル版</a>
      </div>
    </div>

    <script id="hb-program" type="text/x-handlebars-template">
      {{#each this}}
      <li id="ch{{channel}}"><a href="#new-stream" data-channel="{{channel}}" data-rel="popup" data-position-to="window">
	  <h1>{{title}}</h1>
	  <p>{{channel_disc}}: <strong>{{name}}</strong></p>
	  <p>{{description}}</p>
	  <p class="ui-li-aside">{{starttime_rel}}-{{endtime_rel}}</p>
	  <a href="#program-detail" data-channel="{{channel}}" data-rel="popup" data-position-to="window" data-transition="pop">番組詳細</a>
	</a>
      </li>
      {{/each}}
    </script>

    <script id="hb-program-detail" type="text/x-handlebars-template">
      <h4>{{title}}</h4>
      <div>{{channel_disc}}: <strong>{{name}}</strong></div>
      <div>{{prog_start}} - {{prog_end}}</div>
      <p>{{description}}</p>
    </script>

    <script id="hb-process" type="text/x-handlebars-template">
      {{#each this}}
      <tr>
	<td>{{pid}}</td>
	<td><code>{{args}}</code></td>
	<td><a href="#" data-action="kill" data-pid="{{pid}}" data-role="button" data-mini="true" data-inline="true" data-icon="delete" data-theme="e">停止</a></td>
	{{#if tsserv}}
	<td><a href="tsserv.php?port={{tsserv.port}}">観る</a></td>
	{{else}}
	<td></td>
	{{/if}}

      </tr>
      {{/each}}
    </script>
  </body>
</html>
